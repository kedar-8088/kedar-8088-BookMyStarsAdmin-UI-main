import{u as ee,j as e,d as y,r as te,ad as ae,ae as re,af as se,ag as F,ah as U,ai as ne,X as R,aj as ie,ak as oe,al as de,am as le,an as ce,a as W,t as w,n as N,ao as me}from"./mui-DJAgGlcD.js";import{r as i}from"./react-CeAUEJ0P.js";import{B as g,S as l,M as fe,g as he}from"./index-BvpLlJd4.js";import{a as p}from"./vendor-BhB35ZXg.js";import{d as ue,h as $}from"./Add-DIF5rR4-.js";const ge=async n=>await p({method:"get",url:`${g}/advertisement/v1/getAllAdvertisementByPagination/{pageNumber}/{pageSize}?pageNumber=0&pageSize=10`,headers:n}),pe=async(n,o)=>{try{const a=await p({method:"POST",url:`${g}/advertisement/v1/createAdvertisement`,headers:o,data:n});a.data.responseCode===201?l.fire("Success",a.data.message,"success"):a.data.responseCode===400&&l.fire("Error",a.data.errorMessage,"error")}catch(a){l.fire("Error",a.message,"error")}},ve=async(n,o)=>await p({method:"delete",url:`${g}/advertisement/v1/deleteAdvertisementById/${n}`,headers:o}).then(a=>{a.data.responseCode===200?l.fire("Deleted!",a.data.message,"success"):a.data.responseCode===400&&l.fire("Error",a.data.errorMessage,"error")}).catch(a=>{l.fire("Error",a.message,"error")}),xe=async(n,o)=>await p({method:"GET",url:`${g}/advertisement/v1/getAdvertisementByAdvertisementId/{advertisementId}?advertisementId=${n}`,headers:o}),ye=async(n,o)=>(console.log(n),await p({method:"PUT",url:`${g}/advertisement/v1/updateAdvertisement`,headers:o,data:n}).then(a=>{a.data.responseCode===201?l.fire("Success",a.data.message,"success"):a.data.responseCode===400&&l.fire("Error",a.data.errorMessage,"error")}).catch(a=>{l.fire("Error",a.message,"error")})),be=({filePath:n})=>{const[o,a]=i.useState(""),m=JSON.parse(sessionStorage.getItem("user"));return i.useEffect(()=>n?((async()=>{try{const f=await p.get(`${g}/file/downloadFile/?filePath=${encodeURIComponent(n)}`,{headers:{Authorization:`Bearer ${m==null?void 0:m.accessToken}`},responseType:"blob"}),C=new Blob([f.data],{type:f.headers["content-type"]}),h=URL.createObjectURL(C);a(h)}catch(f){console.error("Error fetching image:",f),a("")}})(),()=>{o&&URL.revokeObjectURL(o)}):void 0,[n,m==null?void 0:m.accessToken]),o?e.jsx("img",{src:o,style:{width:80,height:50},alt:"Advertisement"}):"Loading..."},O=[{id:"advertisementId",label:"ID"},{id:"advertisementName",label:"Name",minWidth:100},{id:"description",label:"Description",minWidth:100},{id:"file",label:"File"},{id:"createdBy",label:"Created By",align:"right"},{id:"updatedBy",label:"Updated By",align:"right"},{id:"insertedDate",label:"Inserted Date",align:"right"},{id:"updatedDate",label:"Updated Date",align:"right"},{id:"actions",label:"Actions",align:"right"}],Ee=()=>{ee();const[n,o]=i.useState(0),[a,m]=i.useState(10),[j,f]=i.useState([]),[C,h]=i.useState(!1),[B,I]=i.useState(!1),[d,v]=i.useState({advertisementName:"",description:"",fileName:""}),[u,S]=i.useState({}),[Ne,E]=i.useState(""),[je,A]=i.useState(""),[D,z]=i.useState(null),[M,T]=i.useState(!1),[L,H]=i.useState(null),P=i.useRef(null),G=(t,s)=>{o(s)},Y=t=>{m(+t.target.value),o(0)},b=JSON.parse(sessionStorage.getItem("user")),x={"Content-type":"application/json",Authorization:"Bearer "+b.accessToken},J=async()=>{try{const t=await ge(x),s=t.data.content;if(console.log(t.data.content),s){const r=s.map(c=>({advertisementId:c.advertisementId,advertisementName:c.advertisementName,description:c.description,file:c.filePath?e.jsx(be,{filePath:c.filePath}):"NO IMAGE FOUND",insertedDate:$(c.insertedDate).format("L"),updatedDate:$(c.updatedDate).format("L"),createdBy:c.createdBy?c.createdBy.userName:"No User",updatedBy:c.updatedBy?c.updatedBy.userName:"No User"}));f(r)}else f([])}catch(t){console.error("Error fetching data:",t)}};i.useEffect(()=>{J()},[M]);const q=async t=>{t.preventDefault();const s=_();if(Object.keys(s).length>0)S(s);else try{if(B){const r={...d,advertisementId:L,updatedBy:{userId:b.userId}};await ye(r,x)}else await pe(d,x);v({advertisementName:"",description:"",fileName:""}),P.current.value=null,T(r=>!r),h(!1)}catch(r){console.error("Error saving advertisement:",r)}},V=async t=>{if(t.preventDefault(),!D){E("Please select a file");return}const s=new FormData;s.append("file",D);try{const r=await p.post(`${g}/file/uploadFile`,s,{headers:{"content-type":"multipart/form-data",Authorization:"Bearer "+b.accessToken}});A(r.data.fileName),alert(r.data.message),v({...d,fileName:r.data.fileName}),E("")}catch(r){console.error("Error uploading file:",r)}},X=t=>{A(t.target.files[0].name),z(t.target.files[0])},_=()=>{const t={};return(!d.advertisementName||d.advertisementName.trim()==="")&&(t.advertisementName="Enter the Advertisement name"),(!d.description||d.description.trim()==="")&&(t.description="Enter the description"),(!d.fileName||d.fileName.trim()==="")&&(t.fileName="Select the file"),t},k=t=>{v({...d,[t.target.name]:t.target.value,createdBy:{userId:b.userId}}),S({...u,[t.target.name]:null})},K=()=>{I(!1),v({advertisementName:"",description:"",fileName:""}),h(!0)},Q=async t=>{I(!0),h(!0);try{const r=(await xe(t,x)).data;H(r.advertisementId),v({advertisementName:r.advertisementName,description:r.description,fileName:r.fileName})}catch(s){console.error("Error fetching advertisement details:",s)}},Z=async t=>{l.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(async s=>{if(s.isConfirmed)try{await ve(t,x),T(r=>!r),l.fire({title:"Deleted!",text:"Your file has been deleted.",icon:"success"})}catch(r){l.fire({title:"Error!",text:"There was a problem deleting the record.",icon:"error"}),console.error("Error deleting qualification:",r)}})};return e.jsxs(fe,{title:e.jsxs(W,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Banner"}),e.jsxs(N,{variant:"contained",style:{backgroundColor:"#00afb5",color:"white"},sx:{display:"flex",alignItems:"center",fontSize:"15px"},onClick:K,children:["Add",e.jsx(ue,{sx:{color:"#fff"}})]})]}),children:[e.jsx(y,{container:!0,spacing:he}),e.jsxs(te,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(ae,{sx:{maxHeight:440},children:e.jsxs(re,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(se,{children:e.jsx(F,{children:O.map(t=>e.jsx(U,{align:t.align,style:{minWidth:t.minWidth,fontWeight:600,fontSize:15},children:t.label},t.id))})}),e.jsx(ne,{children:j.slice(n*a,n*a+a).map(t=>e.jsx(F,{hover:!0,role:"checkbox",tabIndex:-1,children:O.map(s=>e.jsx(U,{align:s.align,children:s.id==="actions"?e.jsxs(e.Fragment,{children:[e.jsx(R,{onClick:()=>Q(t.advertisementId),style:{color:"#00afb5"},children:e.jsx(ie,{})}),e.jsx(R,{onClick:()=>Z(t.advertisementId),color:"error",children:e.jsx(oe,{})})]}):t[s.id]},s.id))},t.advertisementId))})]})}),e.jsx(de,{rowsPerPageOptions:[10,25,100],component:"div",count:j.length,rowsPerPage:a,page:n,onPageChange:G,onRowsPerPageChange:Y})]}),e.jsxs(le,{open:C,onClose:()=>h(!1),fullWidth:!0,maxWidth:"md",children:[e.jsx(ce,{sx:{fontWeight:"bold",fontSize:"1.25rem",backgroundColor:"#f5f5f5"},children:B?"Edit Advertisement":"Add Advertisement"}),e.jsxs(W,{component:"form",onSubmit:q,noValidate:!0,sx:{p:3},children:[e.jsxs(y,{container:!0,spacing:2,children:[e.jsx(y,{item:!0,xs:12,children:e.jsx(w,{fullWidth:!0,label:"Advertisement Name",name:"advertisementName",value:d.advertisementName,onChange:k,error:!!u.advertisementName,helperText:u.advertisementName})}),e.jsx(y,{item:!0,xs:12,children:e.jsx(w,{fullWidth:!0,label:"Description",name:"description",value:d.description,onChange:k,error:!!u.description,helperText:u.description,multiline:!0,rows:3})}),e.jsxs(y,{item:!0,xs:12,children:[e.jsx(w,{margin:"normal",fullWidth:!0,id:"fileName",label:"File Name",name:"fileName",autoComplete:"fileName",value:d.fileName,disabled:!0,helperText:u.fileName,error:!!u.fileName,InputProps:{endAdornment:e.jsx(N,{variant:"contained",style:{backgroundColor:"#00afb5",color:"white"},onClick:V,children:"Upload"})}}),e.jsx("input",{type:"file",onChange:X,ref:P,style:{marginTop:20}})]})]}),e.jsxs(me,{children:[e.jsx(N,{type:"submit",variant:"contained",style:{backgroundColor:"#00afb5",color:"white"},children:B?"Edit":"Add"}),e.jsx(N,{onClick:()=>h(!1),style:{color:"#00afb5"},children:"Cancel"})]})]})]})]})};export{Ee as default};
