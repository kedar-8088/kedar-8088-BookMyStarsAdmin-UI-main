import{j as t,a as p,d as c,P as x}from"./mui-BHd6aP3D.js";import{r as o}from"./react-CeAUEJ0P.js";import{a as y}from"./vendor-BhB35ZXg.js";import{M as w,B as m,g}from"./index-CqEkO1RD.js";import{j}from"./carousel.min-CSLkq13g.js";const v=({filePath:s})=>{const[e,a]=o.useState(""),r=JSON.parse(sessionStorage.getItem("user"));return o.useEffect(()=>s?((async()=>{var l;try{const n=await y.get(`${m}/bookmystarsadmin/file/downloadFile/?filePath=${encodeURIComponent(s)}`,{headers:{Authorization:`Bearer ${r==null?void 0:r.accessToken}`},responseType:"blob"}),i=new Blob([n.data],{type:n.headers["content-type"]}),h=URL.createObjectURL(i);a(h)}catch(n){console.error("Error fetching image:",n),((l=n.response)==null?void 0:l.status)===404&&console.warn(`Image not found: ${s}`),a("")}})(),()=>{e&&URL.revokeObjectURL(e)}):void 0,[s,r==null?void 0:r.accessToken]),e?t.jsx("img",{src:e,style:{width:"100%",height:"100%",objectFit:"cover"},alt:"Advertisement"}):"Loading..."},b=async s=>{try{const e=await fetch(`${m}/bookmystarsadmin/advertisement/v1/queryAllAdvertisement`,{method:"GET",headers:s});if(!e.ok)throw e.status===404&&console.warn("Banner endpoint not found (404). The endpoint might not exist on the server."),new Error(`HTTP error! Status: ${e.status}`);return await e.json()}catch(e){if(console.error("Error fetching banner data:",e),e.message.includes("404")){console.warn("Trying alternative endpoint...");try{const a=await fetch(`${m}/bookmystarsadmin/advertisement/v1/getAllAdvertisementByPagination/0/100`,{method:"GET",headers:s});if(a.ok){const r=await a.json();return r.content||r.data||r}}catch(a){console.error("Alternative endpoint also failed:",a)}}return[]}},f=()=>{const[s,e]=o.useState([]),[a,r]=o.useState(!0),d=JSON.parse(sessionStorage.getItem("user")),l={"Content-Type":"application/json",Authorization:`Bearer ${d==null?void 0:d.accessToken}`};return o.useEffect(()=>{(async()=>{r(!0);try{const i=await b(l);if(i.length>0){const h=i.map(u=>({advertisementId:u.advertisementId,filePath:u.filePath||null}));e(h)}else e([])}catch(i){console.error("Error fetching data:",i)}finally{r(!1)}})()},[]),t.jsx(w,{border:!1,content:!1,sx:{mt:4,width:"100%",height:450},children:t.jsx(p,{sx:{width:"100%",height:"100%"},children:t.jsx(c,{container:!0,direction:"column",sx:{width:"100%",height:"100%"},children:t.jsx(c,{item:!0,xs:12,sx:{width:"100%",height:"100%"},children:a?t.jsx("div",{style:{textAlign:"center",padding:"20px"},children:"Loading..."}):t.jsx(j.Carousel,{showThumbs:!1,showArrows:!0,showIndicators:!0,showStatus:!1,infiniteLoop:!0,autoPlay:!0,interval:3e3,transitionTime:500,stopOnHover:!0,dynamicHeight:!1,swipeable:!0,emulateTouch:!0,style:{width:"100%",height:450},children:s.length>0?s.map(n=>n.filePath?t.jsx("div",{style:{width:"100%",height:450},children:t.jsx(v,{filePath:n.filePath})},n.advertisementId):null):t.jsx("div",{style:{textAlign:"center",padding:"20px"},children:"No Data"})})})})})})};f.propTypes={isLoading:x.bool};const L=()=>{const[s,e]=o.useState(!0);return o.useEffect(()=>{e(!1)},[]),t.jsx(c,{container:!0,spacing:g,children:t.jsx(c,{item:!0,xs:12,children:t.jsx(c,{container:!0,spacing:g,children:t.jsx(c,{item:!0,lg:12,md:12,sm:12,xs:12,children:t.jsx(f,{isLoading:s})})})})})};export{L as default};
