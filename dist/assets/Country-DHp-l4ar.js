import{u as ie,j as e,a as n,d as l,ap as le,aw as M,ar as ce,as as R,at as de,au as ue,n as w,am as xe,an as he,t as O,Y as ge,av as ye,ao as me,T as c,c as fe,f as pe,A as je,h as L,D as be,X as f,aj as V,ak as U,r as Ce,ad as ve,ae as we,af as De,ag as D,ah as A,ai as Ae,al as Se}from"./mui-DJAgGlcD.js";import{r as s}from"./react-CeAUEJ0P.js";import{M as Ie,g as Ee,S as p}from"./index-BvpLlJd4.js";import{f as ke,u as Ne,a as Te,g as Fe,d as Be}from"./CountryApi-BRddreOc.js";import{d as Pe,h as H}from"./Add-DIF5rR4-.js";import"./vendor-BhB35ZXg.js";const S=[{id:"countryId",label:"ID"},{id:"countryName",label:"Country Name",minWidth:150},{id:"countryCode",label:"Country Code",minWidth:120},{id:"isActive",label:"Status",align:"center"},{id:"insertedDate",label:"Created Date",align:"right"},{id:"updatedDate",label:"Updated Date",align:"right"},{id:"actions",label:"Actions",align:"right"}],Ve=()=>{ie();const[j,I]=s.useState(0),[b,Y]=s.useState(10),[d,E]=s.useState([]),[G,u]=s.useState(!1),[C,k]=s.useState(!1),[N,J]=s.useState("list"),[o,m]=s.useState({countryName:"",countryCode:"",isActive:!0}),[x,T]=s.useState({}),[X,F]=s.useState(!1),[_,q]=s.useState(null),[B,P]=s.useState(0),K=(t,r)=>{I(r)},Q=t=>{Y(+t.target.value),I(0)},Z=(t,r)=>{r!==null&&J(r)},h=JSON.parse(sessionStorage.getItem("user")),g={"Content-Type":"application/json",Authorization:"Bearer "+(h==null?void 0:h.accessToken)},$=async()=>{var t,r;try{if(!h||!h.accessToken){console.error("User not authenticated"),p.fire("Error","Please login to continue","error");return}const a=await ke(g,j,b),y=((t=a.data.data)==null?void 0:t.countries)||[],oe=((r=a.data.data)==null?void 0:r.totalCount)||0;if(y&&Array.isArray(y)){const se=y.map(i=>({countryId:i.countryId,countryName:i.countryName,countryCode:i.countryCode,isActive:i.isActive?"Active":"Inactive",insertedDate:i.insertedDate?H(i.insertedDate).format("L"):"N/A",updatedDate:i.updatedDate?H(i.updatedDate).format("L"):"N/A"}));E(se),P(oe)}else E([]),P(0)}catch(a){console.error("Error fetching data:",a)}};s.useEffect(()=>{$()},[X,j,b]);const ee=async t=>{t.preventDefault();const r=te();if(Object.keys(r).length>0)T(r);else try{if(C){const a={countryId:_,countryName:o.countryName,countryCode:o.countryCode,isActive:o.isActive};await Ne(a,g)}else{const a={...o,insertedDate:new Date().toISOString(),updatedDate:new Date().toISOString()};await Te(a,g)}m({countryName:"",countryCode:"",isActive:!0}),F(a=>!a),u(!1)}catch(a){console.error("Error saving country:",a)}},te=()=>{const t={};return(!o.countryName||o.countryName.trim()==="")&&(t.countryName="Enter the country name"),(!o.countryCode||o.countryCode.trim()==="")&&(t.countryCode="Enter the country code"),t},v=t=>{const{name:r,value:a,checked:y}=t.target;m({...o,[r]:r==="isActive"?y:a}),T({...x,[r]:null})},re=()=>{k(!1),m({countryName:"",countryCode:"",isActive:!0}),u(!0)},W=async t=>{k(!0),u(!0);try{const r=await Fe(t,g),a=r.data.data||r.data;q(a.countryId),m({countryName:a.countryName,countryCode:a.countryCode,isActive:a.isActive})}catch(r){console.error("Error fetching country details:",r)}},z=async t=>{p.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(async r=>{if(r.isConfirmed)try{await Be(t,g),F(a=>!a),p.fire({title:"Deleted!",text:"Country has been deleted.",icon:"success"})}catch(a){p.fire({title:"Error!",text:"There was a problem deleting the country.",icon:"error"}),console.error("Error deleting country:",a)}})},ae=()=>e.jsx(l,{container:!0,spacing:3,children:d.length===0?e.jsx(l,{item:!0,xs:12,children:e.jsxs(n,{sx:{textAlign:"center",py:4},children:[e.jsx(c,{variant:"h6",color:"textSecondary",children:"No countries found"}),e.jsxs(c,{variant:"body2",color:"textSecondary",children:["Countries array length: ",d.length]})]})}):d.map(t=>e.jsx(l,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsxs(fe,{sx:{height:"100%",display:"flex",flexDirection:"column",background:"linear-gradient(135deg, #F48FB1 0%, #F8BBD9 100%)",color:"#880E4F",position:"relative",overflow:"hidden","&:hover":{transform:"translateY(-4px)",boxShadow:"0 8px 25px rgba(0,0,0,0.15)",transition:"all 0.3s ease"}},children:[e.jsx(n,{sx:{position:"absolute",top:0,right:0,width:100,height:100,background:"rgba(255,255,255,0.3)",borderRadius:"50%",transform:"translate(30px, -30px)"}}),e.jsxs(pe,{sx:{flexGrow:1,position:"relative",zIndex:1},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(je,{sx:{bgcolor:"rgba(136, 14, 79, 0.2)",mr:2,width:40,height:40,color:"#880E4F"},children:e.jsx(M,{})}),e.jsxs(n,{children:[e.jsx(c,{variant:"h6",sx:{fontWeight:"bold",mb:.5,color:"#880E4F"},children:t.countryName}),e.jsxs(n,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e.jsx(L,{label:t.countryCode,size:"small",sx:{bgcolor:"rgba(136, 14, 79, 0.2)",color:"#880E4F",fontWeight:"bold",fontSize:"0.7rem"}}),e.jsx(L,{label:t.isActive,size:"small",sx:{bgcolor:t.isActive==="Active"?"rgba(76, 175, 80, 0.9)":"rgba(244, 67, 54, 0.9)",color:"white",fontWeight:"bold"}})]})]})]}),e.jsx(c,{variant:"body2",sx:{mb:2,opacity:.8,color:"#880E4F",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t.countryDescription}),e.jsx(be,{sx:{my:1,bgcolor:"rgba(136, 14, 79, 0.2)"}}),e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[e.jsxs(c,{variant:"caption",sx:{opacity:.7,color:"#880E4F"},children:["ID: ",t.countryId]}),e.jsx(c,{variant:"caption",sx:{opacity:.7,color:"#880E4F"},children:t.insertedDate})]}),e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(c,{variant:"caption",sx:{opacity:.7,color:"#880E4F"},children:["Updated: ",t.updatedDate]}),e.jsxs(n,{children:[e.jsx(f,{size:"small",onClick:()=>W(t.countryId),sx:{color:"#880E4F","&:hover":{bgcolor:"rgba(136, 14, 79, 0.1)"}},children:e.jsx(V,{fontSize:"small"})}),e.jsx(f,{size:"small",onClick:()=>z(t.countryId),sx:{color:"#880E4F","&:hover":{bgcolor:"rgba(136, 14, 79, 0.1)"}},children:e.jsx(U,{fontSize:"small"})})]})]})]})]})},t.countryId))}),ne=()=>e.jsxs(Ce,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(ve,{sx:{maxHeight:440},children:e.jsxs(we,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(De,{children:e.jsx(D,{children:S.map(t=>e.jsx(A,{align:t.align,style:{minWidth:t.minWidth,fontWeight:600,fontSize:15},children:t.label},t.id))})}),e.jsx(Ae,{children:d.length===0?e.jsx(D,{children:e.jsx(A,{colSpan:S.length,align:"center",children:e.jsxs(n,{sx:{py:2},children:[e.jsx("div",{children:"No countries found"}),e.jsxs("div",{style:{fontSize:"12px",color:"gray"},children:["Countries array length: ",d.length]})]})})}):d.map(t=>e.jsx(D,{hover:!0,role:"checkbox",tabIndex:-1,children:S.map(r=>e.jsx(A,{align:r.align,children:r.id==="actions"?e.jsxs(e.Fragment,{children:[e.jsx(f,{onClick:()=>W(t.countryId),style:{color:"#00afb5"},children:e.jsx(V,{})}),e.jsx(f,{onClick:()=>z(t.countryId),color:"error",children:e.jsx(U,{})})]}):r.id==="isActive"?e.jsx(n,{sx:{backgroundColor:t[r.id]==="Active"?"#4caf50":"#f44336",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold"},children:t[r.id]}):t[r.id]},r.id))},t.countryId))})]})}),e.jsx(Se,{rowsPerPageOptions:[10,25,100],component:"div",count:B,rowsPerPage:b,page:j,onPageChange:K,onRowsPerPageChange:Q})]});return e.jsxs(n,{sx:{mt:4},children:[e.jsxs(Ie,{title:e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{children:"Country Management"}),e.jsx(le,{badgeContent:B,color:"primary",children:e.jsx(M,{color:"action"})})]}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs(ce,{value:N,exclusive:!0,onChange:Z,size:"small",sx:{bgcolor:"background.paper"},children:[e.jsx(R,{value:"list","aria-label":"list view",children:e.jsx(de,{})}),e.jsx(R,{value:"card","aria-label":"card view",children:e.jsx(ue,{})})]}),e.jsxs(w,{variant:"contained",style:{backgroundColor:"#00afb5",color:"white"},sx:{display:"flex",alignItems:"center",fontSize:"15px"},onClick:re,children:["Add Country",e.jsx(Pe,{sx:{color:"#fff"}})]})]})]}),children:[e.jsx(l,{container:!0,spacing:Ee}),N==="card"?ae():ne()]}),e.jsxs(xe,{open:G,onClose:()=>u(!1),fullWidth:!0,maxWidth:"md",children:[e.jsx(he,{sx:{fontWeight:"bold",fontSize:"1.25rem",backgroundColor:"#f5f5f5"},children:C?"Edit Country":"Add Country"}),e.jsxs(n,{component:"form",onSubmit:ee,noValidate:!0,sx:{p:3},children:[e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{item:!0,xs:12,children:e.jsx(O,{fullWidth:!0,label:"Country Name",name:"countryName",value:o.countryName,onChange:v,error:!!x.countryName,helperText:x.countryName})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(O,{fullWidth:!0,label:"Country Code",name:"countryCode",value:o.countryCode,onChange:v,error:!!x.countryCode,helperText:x.countryCode})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(ge,{control:e.jsx(ye,{checked:o.isActive,onChange:v,name:"isActive",color:"primary"}),label:"Active Status"})})]}),e.jsxs(me,{children:[e.jsx(w,{type:"submit",variant:"contained",style:{backgroundColor:"#00afb5",color:"white"},children:C?"Update":"Add"}),e.jsx(w,{onClick:()=>u(!1),style:{color:"#00afb5"},children:"Cancel"})]})]})]})]})};export{Ve as default};
