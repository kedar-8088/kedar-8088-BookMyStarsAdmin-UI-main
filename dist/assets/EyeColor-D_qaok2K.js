import{u as be,q as K,j as e,a as h,d as E,T as j,ap as Ce,aF as ve,ar as je,as as Z,at as we,au as Ee,n as V,am as De,an as Ae,t as ee,aC as $,Y as Se,av as ke,ao as Ie,c as Te,f as ze,A as Fe,h as Ne,D as Be,X as P,aj as re,ak as oe,r as Pe,ad as We,ae as Me,af as Re,ag as O,ah as L,ai as Ve,al as $e}from"./mui-BHd6aP3D.js";import{r as b}from"./react-CeAUEJ0P.js";import{B as k,S as y,M as Oe,g as Le}from"./index-CqEkO1RD.js";import{a as I}from"./vendor-BhB35ZXg.js";import{d as Ue,h as te}from"./Add-Hd0l8K7I.js";const Ge=async(u,t=0,f=10)=>await I({method:"get",url:`${k}/bookmystarsadmin/eye-color/v1/getAllByPagination?pageNumber=${t}&pageSize=${f}`,headers:u}),He=async(u,t)=>{var f,m,C;try{const s=await I({method:"POST",url:`${k}/bookmystarsadmin/eye-color/v1/create`,headers:t,data:u}),l=((f=s==null?void 0:s.data)==null?void 0:f.body)||(s==null?void 0:s.data),p=l==null?void 0:l.code,i=(l==null?void 0:l.message)||"Eye Color created successfully",c=(l==null?void 0:l.error)||"An error occurred";p===200?y.fire("Success",i,"success"):p===400?y.fire("Error",c,"error"):y.fire("Success",i,"success")}catch(s){console.error("Error adding eye color:",s);const l=((C=(m=s==null?void 0:s.response)==null?void 0:m.data)==null?void 0:C.message)||(s==null?void 0:s.message)||"Failed to add eye color";y.fire("Error",l,"error")}},Ye=async(u,t)=>{var f,m,C;try{const s=await I({method:"delete",url:`${k}/bookmystarsadmin/eye-color/v1/delete/${u}`,headers:t}),l=((f=s==null?void 0:s.data)==null?void 0:f.body)||(s==null?void 0:s.data),p=l==null?void 0:l.code,i=(l==null?void 0:l.message)||"Eye Color deleted successfully",c=(l==null?void 0:l.error)||"An error occurred";p===200?y.fire("Deleted!",i,"success"):p===400?y.fire("Error",c,"error"):y.fire("Deleted!",i,"success")}catch(s){console.error("Error deleting eye color:",s);const l=((C=(m=s==null?void 0:s.response)==null?void 0:m.data)==null?void 0:C.message)||(s==null?void 0:s.message)||"Failed to delete eye color";y.fire("Error",l,"error")}},Xe=async(u,t)=>await I({method:"GET",url:`${k}/bookmystarsadmin/eye-color/v1/get/${u}`,headers:t}),_e=async(u,t)=>{var f,m,C,s,l,p;try{const i=await I({method:"PUT",url:`${k}/bookmystarsadmin/eye-color/v1/update`,headers:t,data:u}),c=((f=i==null?void 0:i.data)==null?void 0:f.body)||(i==null?void 0:i.data),d=c==null?void 0:c.code,A=(c==null?void 0:c.message)||"Eye Color updated successfully",T=(c==null?void 0:c.error)||"An error occurred";d===200?y.fire("Success",A,"success"):d===400?y.fire("Error",T,"error"):y.fire("Success",A,"success")}catch(i){console.error("Error updating eye color:",i),console.error("Error response data:",(m=i==null?void 0:i.response)==null?void 0:m.data),console.error("Error status:",(C=i==null?void 0:i.response)==null?void 0:C.status);let c="Failed to update eye color";if((s=i==null?void 0:i.response)!=null&&s.data){const d=i.response.data;d.error&&typeof d.error=="string"?d.error.includes("foreign key constraint")?c="Database error: Invalid user reference. Please contact administrator.":d.error.includes("violates foreign key constraint")?c="Database error: The referenced user does not exist. Please contact administrator.":c=d.error:d.message?c=d.message:(l=d.body)!=null&&l.error?c=d.body.error:(p=d.body)!=null&&p.message?c=d.body.message:typeof d=="string"&&(c=d)}else i!=null&&i.message&&(c=i.message);throw y.fire("Error",c,"error"),i}},qe=async u=>await I({method:"GET",url:`${k}/bookmystarsadmin/eye-color/v1/count`,headers:u}),U=[{id:"eyeColorId",label:"ID"},{id:"eyeColorName",label:"Eye Color Name",minWidth:150},{id:"eyeColorDescription",label:"Description",minWidth:200},{id:"isActive",label:"Status",align:"center"},{id:"insertedDate",label:"Created Date",align:"right"},{id:"updatedDate",label:"Updated Date",align:"right"},{id:"actions",label:"Actions",align:"right"}],W=u=>{if(!u)return"#9E9E9E";const t={black:"#2C2C2C",brown:"#8B4513",hazel:"#C9A961",amber:"#FFBF00",blue:"#2196F3",green:"#4CAF50",gray:"#9E9E9E",grey:"#9E9E9E",red:"#F44336",violet:"#9C27B0",purple:"#9C27B0",yellow:"#FFEB3B",orange:"#FF9800",pink:"#E91E63",white:"#F5F5F5","light blue":"#64B5F6","dark blue":"#1976D2","light brown":"#A0522D","dark brown":"#5D4037","light green":"#81C784","dark green":"#388E3C","light gray":"#BDBDBD","dark gray":"#616161","light grey":"#BDBDBD","dark grey":"#616161"},f=u.toLowerCase().trim();if(t[f])return t[f];for(const[m,C]of Object.entries(t))if(f.includes(m)||m.includes(f))return C;return"#9E9E9E"},rr=()=>{const u=be(),t=K(u.breakpoints.down("sm")),f=K(u.breakpoints.down("md")),[m,C]=b.useState(0),[s,l]=b.useState(10),[p,i]=b.useState([]),[c,d]=b.useState(!1),[A,T]=b.useState(!1),[G,ae]=b.useState("list"),[g,z]=b.useState({eyeColorName:"",eyeColorDescription:"",isActive:!0}),[F,B]=b.useState({}),[se,H]=b.useState(!1),[ie,Y]=b.useState(null),[le,M]=b.useState(0),[X,_]=b.useState(0),ne=(o,r)=>{C(r)},ce=o=>{l(+o.target.value),C(0)},de=(o,r)=>{r!==null&&ae(r)},N=JSON.parse(sessionStorage.getItem("user")),S={"Content-Type":"application/json",Authorization:"Bearer "+(N==null?void 0:N.accessToken)},xe=async()=>{var o;try{if(!N||!N.accessToken){console.error("User not authenticated"),y.fire("Error","Please login to continue","error");return}const r=await Ge(S,m,s),a=((o=r==null?void 0:r.data)==null?void 0:o.body)??(r==null?void 0:r.data),n=a==null?void 0:a.data,x=(n==null?void 0:n.content)||(n==null?void 0:n.eyeColors)||n||[],D=n!=null&&n.totalElements||n!=null&&n.totalCount||Array.isArray(x)?x.length:0;if(x&&Array.isArray(x)){const w=x.map(v=>{const pe=v.isActive!==void 0?!!v.isActive:v.active!==void 0?!!v.active:!0;return{eyeColorId:v.eyeColorId,eyeColorName:v.eyeColorName||"N/A",eyeColorDescription:v.eyeColorDescription||"N/A",isActive:pe?"Active":"Inactive",insertedDate:v.insertedDate?te(v.insertedDate).format("L"):"N/A",updatedDate:v.updatedDate?te(v.updatedDate).format("L"):"N/A"}});i(w),M(typeof D=="number"?D:0)}else i([]),M(0)}catch(r){console.error("Error fetching data:",r),y.fire("Error","Failed to load eye colors. Please try again.","error"),i([]),M(0)}},he=async()=>{var o;try{const r=await qe(S),a=((o=r==null?void 0:r.data)==null?void 0:o.body)??(r==null?void 0:r.data),n=(a==null?void 0:a.data)||a||0,x=typeof n=="number"?n:typeof n=="string"&&parseInt(n,10)||0;_(x)}catch(r){console.error("Error fetching eye color count:",r),_(0)}};b.useEffect(()=>{xe(),he()},[se,m,s]),b.useEffect(()=>{if(c)try{document.activeElement&&document.activeElement.blur()}catch{}},[c]);const ye=async o=>{var a,n,x,D;o.preventDefault();const r=ge();if(Object.keys(r).length>0)B(r);else try{if(A){const w={eyeColorId:ie,eyeColorName:((a=g.eyeColorName)==null?void 0:a.trim())||"",eyeColorDescription:((n=g.eyeColorDescription)==null?void 0:n.trim())||"",isActive:!!g.isActive};await _e(w,S)}else{const w={eyeColorName:((x=g.eyeColorName)==null?void 0:x.trim())||"",eyeColorDescription:((D=g.eyeColorDescription)==null?void 0:D.trim())||"",isActive:!!g.isActive};await He(w,S)}z({eyeColorName:"",eyeColorDescription:"",isActive:!0}),H(w=>!w),d(!1)}catch(w){console.error("Error saving eye color:",w),y.fire("Error","Failed to save eye color. Please try again.","error")}},ge=()=>{const o={};return(!g.eyeColorName||g.eyeColorName.trim()==="")&&(o.eyeColorName="Enter the eye color name"),(!g.eyeColorDescription||g.eyeColorDescription.trim()==="")&&(o.eyeColorDescription="Enter the eye color description"),o},R=o=>{const{name:r,value:a,checked:n}=o.target;z({...g,[r]:r==="isActive"?n:a}),B({...F,[r]:null})},ue=()=>{T(!1),z({eyeColorName:"",eyeColorDescription:"",isActive:!0}),B({}),d(!0)},q=()=>{d(!1),T(!1),z({eyeColorName:"",eyeColorDescription:"",isActive:!0}),B({}),Y(null)},J=async o=>{var r;T(!0),d(!0);try{const a=await Xe(o,S),n=((r=a==null?void 0:a.data)==null?void 0:r.body)??(a==null?void 0:a.data),x=(n==null?void 0:n.data)||n;if(x&&x.eyeColorId){console.log("Eye Color details for edit:",x);const D=x.isActive!==void 0?x.isActive:x.active!==void 0?x.active:!0;Y(x.eyeColorId),z({eyeColorName:x.eyeColorName||"",eyeColorDescription:x.eyeColorDescription||"",isActive:!!D})}else y.fire("Error","Failed to load eye color details","error"),d(!1)}catch(a){console.error("Error fetching eye color details:",a),y.fire("Error","Failed to load eye color details. Please try again.","error"),d(!1)}},Q=async o=>{y.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(async r=>{if(r.isConfirmed)try{await Ye(o,S),H(a=>!a),y.fire({title:"Deleted!",text:"Eye Color has been deleted.",icon:"success"})}catch(a){y.fire({title:"Error!",text:"There was a problem deleting the eye color.",icon:"error"}),console.error("Error deleting eye color:",a)}})},fe=()=>e.jsx(E,{container:!0,spacing:3,children:p.length===0?e.jsx(E,{item:!0,xs:12,children:e.jsxs(h,{sx:{textAlign:"center",py:4},children:[e.jsx(j,{variant:"h6",color:"textSecondary",children:"No eye colors found"}),e.jsxs(j,{variant:"body2",color:"textSecondary",children:["Eye colors array length: ",p.length]})]})}):p.map(o=>e.jsx(E,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsxs(Te,{sx:{height:"100%",display:"flex",flexDirection:"column",background:"linear-gradient(135deg, #E1F5FE 0%, #B3E5FC 100%)",color:"#01579B",position:"relative",overflow:"hidden","&:hover":{transform:"translateY(-4px)",boxShadow:"0 8px 25px rgba(0,0,0,0.15)",transition:"all 0.3s ease"}},children:[e.jsx(h,{sx:{position:"absolute",top:0,right:0,width:100,height:100,background:"rgba(255,255,255,0.3)",borderRadius:"50%",transform:"translate(30px, -30px)"}}),e.jsxs(ze,{sx:{flexGrow:1,position:"relative",zIndex:1},children:[e.jsxs(h,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(Fe,{sx:{bgcolor:W(o.eyeColorName),mr:2,width:50,height:50,border:"3px solid",borderColor:o.isActive==="Active"?"#4caf50":"#f44336",boxShadow:"0 2px 8px rgba(0,0,0,0.2)"},children:e.jsx(h,{sx:{width:"100%",height:"100%",borderRadius:"50%",backgroundColor:W(o.eyeColorName),display:"flex",alignItems:"center",justifyContent:"center"},children:o.isActive==="Active"&&e.jsx($,{sx:{color:"white",fontSize:"20px",filter:"drop-shadow(0 1px 2px rgba(0,0,0,0.5))"}})})}),e.jsxs(h,{children:[e.jsx(j,{variant:"h6",sx:{fontWeight:"bold",mb:.5,color:"#01579B"},children:o.eyeColorName}),e.jsx(h,{sx:{display:"flex",gap:1,alignItems:"center"},children:e.jsx(Ne,{label:o.isActive,size:"small",sx:{bgcolor:o.isActive==="Active"?"rgba(76, 175, 80, 0.9)":"rgba(244, 67, 54, 0.9)",color:"white",fontWeight:"bold"}})})]})]}),e.jsx(j,{variant:"body2",sx:{mb:2,opacity:.8,color:"#01579B",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden"},children:o.eyeColorDescription}),e.jsx(Be,{sx:{my:1,bgcolor:"rgba(1, 87, 155, 0.2)"}}),e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[e.jsxs(j,{variant:"caption",sx:{opacity:.7,color:"#01579B"},children:["ID: ",o.eyeColorId]}),e.jsx(j,{variant:"caption",sx:{opacity:.7,color:"#01579B"},children:o.insertedDate})]}),e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(j,{variant:"caption",sx:{opacity:.7,color:"#01579B"},children:["Updated: ",o.updatedDate]}),e.jsxs(h,{children:[e.jsx(P,{size:"small",onClick:()=>J(o.eyeColorId),sx:{color:"#01579B","&:hover":{bgcolor:"rgba(1, 87, 155, 0.1)"}},children:e.jsx(re,{fontSize:"small"})}),e.jsx(P,{size:"small",onClick:()=>Q(o.eyeColorId),sx:{color:"#01579B","&:hover":{bgcolor:"rgba(1, 87, 155, 0.1)"}},children:e.jsx(oe,{fontSize:"small"})})]})]})]})]})},o.eyeColorId))}),me=()=>{const o=t?U.filter(r=>["eyeColorId","eyeColorName","actions"].includes(r.id)):f?U.filter(r=>!["insertedDate","updatedDate","eyeColorDescription"].includes(r.id)):U;return e.jsxs(Pe,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(We,{sx:{maxHeight:440,overflowX:"auto","&::-webkit-scrollbar":{height:"8px"},"&::-webkit-scrollbar-track":{backgroundColor:"#f1f1f1"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#888",borderRadius:"4px"},"&::-webkit-scrollbar-thumb:hover":{backgroundColor:"#555"}},children:e.jsxs(Me,{stickyHeader:!0,"aria-label":"sticky table",sx:{minWidth:t?600:"100%"},children:[e.jsx(Re,{children:e.jsx(O,{children:o.map(r=>e.jsx(L,{align:r.align,sx:{minWidth:t?r.minWidth?Math.min(r.minWidth,100):"auto":r.minWidth,fontWeight:600,fontSize:t?13:15,whiteSpace:"nowrap",...r.id==="actions"&&{textAlign:"right"}},children:r.label},r.id))})}),e.jsx(Ve,{children:p.length===0?e.jsx(O,{children:e.jsx(L,{colSpan:o.length,align:"center",children:e.jsxs(h,{sx:{py:2},children:[e.jsx("div",{children:"No eye colors found"}),e.jsxs("div",{style:{fontSize:"12px",color:"gray"},children:["Eye colors array length: ",p.length]})]})})}):p.map(r=>e.jsx(O,{hover:!0,role:"checkbox",tabIndex:-1,children:o.map(a=>e.jsx(L,{align:a.align,sx:{fontSize:t?12:14,whiteSpace:"nowrap",...a.id==="actions"&&{textAlign:"right"}},children:a.id==="actions"?e.jsxs(h,{sx:{display:"flex",gap:.5,flexWrap:"wrap",justifyContent:"flex-end"},children:[e.jsx(P,{size:t?"small":"medium",onClick:()=>J(r.eyeColorId),style:{color:"#00afb5"},children:e.jsx(re,{fontSize:t?"small":"medium"})}),e.jsx(P,{size:t?"small":"medium",onClick:()=>Q(r.eyeColorId),color:"error",children:e.jsx(oe,{fontSize:t?"small":"medium"})})]}):a.id==="isActive"?e.jsx(h,{sx:{backgroundColor:r[a.id]==="Active"?"#4caf50":"#f44336",color:"white",padding:t?"2px 6px":"4px 8px",borderRadius:"4px",fontSize:t?"10px":"12px",fontWeight:"bold",display:"inline-block"},children:r[a.id]}):a.id==="eyeColorDescription"?e.jsx(j,{variant:"body2",sx:{maxWidth:t?120:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:t?12:14},children:r[a.id]}):a.id==="eyeColorName"?e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(h,{sx:{width:t?24:30,height:t?24:30,borderRadius:"50%",backgroundColor:W(r.eyeColorName),border:"2px solid",borderColor:r.isActive==="Active"?"#4caf50":"#f44336",boxShadow:"0 2px 4px rgba(0,0,0,0.2)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:r.isActive==="Active"&&e.jsx($,{sx:{color:"white",fontSize:t?"14px":"16px",filter:"drop-shadow(0 1px 2px rgba(0,0,0,0.5))"}})}),e.jsx(j,{variant:"body2",sx:{fontSize:t?12:14,fontWeight:500},children:r[a.id]})]}):e.jsx(j,{variant:"body2",sx:{fontSize:t?12:14,overflow:"hidden",textOverflow:"ellipsis",maxWidth:t?120:"none"},children:r[a.id]})},a.id))},r.eyeColorId))})]})}),e.jsx($e,{rowsPerPageOptions:t?[10,25]:[10,25,100],component:"div",count:le,rowsPerPage:s,page:m,onPageChange:ne,onRowsPerPageChange:ce,sx:{overflowX:"auto","& .MuiTablePagination-toolbar":{flexWrap:"wrap",gap:1},"& .MuiTablePagination-selectLabel":{fontSize:t?12:14},"& .MuiTablePagination-displayedRows":{fontSize:t?12:14}}})]})};return e.jsxs(h,{sx:{mt:4,px:{xs:1,sm:2}},children:[e.jsxs(Oe,{title:e.jsxs(h,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:{xs:"flex-start",sm:"center"},gap:2,width:"100%"},children:[e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap"},children:[e.jsx(j,{variant:"h4",sx:{fontSize:{xs:"1.2rem",sm:"1.5rem"}},children:"Eye Color Management"}),e.jsx(Ce,{badgeContent:typeof X=="number"?X:0,color:"primary",children:e.jsx(ve,{color:"action"})})]}),e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap",width:{xs:"100%",sm:"auto"},justifyContent:{xs:"flex-start",sm:"flex-end"}},children:[e.jsxs(je,{value:G,exclusive:!0,onChange:de,size:"small",sx:{bgcolor:"background.paper"},children:[e.jsx(Z,{value:"list","aria-label":"list view",children:e.jsx(we,{})}),e.jsx(Z,{value:"card","aria-label":"card view",children:e.jsx(Ee,{})})]}),e.jsxs(V,{variant:"contained",style:{backgroundColor:"#00afb5",color:"white"},sx:{display:"flex",alignItems:"center",fontSize:{xs:"13px",sm:"15px"},whiteSpace:"nowrap",width:{xs:"100%",sm:"auto"}},onClick:ue,children:[t?"Add":"Add Eye Color",e.jsx(Ue,{sx:{color:"#fff",ml:.5}})]})]})]}),children:[e.jsx(E,{container:!0,spacing:Le}),G==="card"?fe():me()]}),e.jsxs(De,{open:c,onClose:q,fullWidth:!0,maxWidth:t?"xs":"md",fullScreen:t,children:[e.jsx(Ae,{sx:{fontWeight:"bold",fontSize:"1.25rem",backgroundColor:"#f5f5f5"},children:A?"Edit Eye Color":"Add Eye Color"}),e.jsxs(h,{component:"form",onSubmit:ye,noValidate:!0,sx:{p:{xs:2,sm:3}},children:[e.jsxs(E,{container:!0,spacing:2,children:[e.jsx(E,{item:!0,xs:12,md:6,children:e.jsxs(h,{sx:{display:"flex",alignItems:"flex-start",gap:2},children:[e.jsx(ee,{fullWidth:!0,label:"Eye Color Name",name:"eyeColorName",value:g.eyeColorName,onChange:R,error:!!F.eyeColorName,helperText:F.eyeColorName,placeholder:"e.g., Brown, Blue, Green, Hazel"}),g.eyeColorName&&e.jsx(h,{sx:{width:60,height:60,borderRadius:"50%",backgroundColor:W(g.eyeColorName),border:"3px solid",borderColor:g.isActive?"#4caf50":"#f44336",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",display:"flex",alignItems:"center",justifyContent:"center",mt:1,flexShrink:0},children:g.isActive&&e.jsx($,{sx:{color:"white",fontSize:"24px",filter:"drop-shadow(0 1px 2px rgba(0,0,0,0.5))"}})})]})}),e.jsx(E,{item:!0,xs:12,children:e.jsx(ee,{fullWidth:!0,label:"Eye Color Description",name:"eyeColorDescription",value:g.eyeColorDescription,onChange:R,error:!!F.eyeColorDescription,helperText:F.eyeColorDescription,placeholder:"Describe the eye color characteristics",multiline:!0,rows:4})}),e.jsx(E,{item:!0,xs:12,children:e.jsx(Se,{control:e.jsx(ke,{checked:g.isActive,onChange:R,name:"isActive",color:"primary"}),label:"Active Status"})})]}),e.jsxs(Ie,{children:[e.jsx(V,{type:"submit",variant:"contained",style:{backgroundColor:"#00afb5",color:"white"},children:A?"Update":"Add"}),e.jsx(V,{onClick:q,style:{color:"#00afb5"},children:"Cancel"})]})]})]})]})};export{rr as default};
