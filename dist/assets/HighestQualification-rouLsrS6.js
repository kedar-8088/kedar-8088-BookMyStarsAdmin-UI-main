import{u as be,q as J,j as e,a as f,d as A,T as w,ap as ve,aH as K,ar as je,as as Z,at as ye,au as Qe,n as M,am as De,an as we,t as ee,Y as Ae,av as Ce,ao as Ee,c as Se,f as ke,A as Ie,h as Ne,D as Te,X as H,aj as ie,ak as te,r as qe,ad as He,ae as Pe,af as We,ag as F,ah as $,ai as ze,al as Me}from"./mui-BHd6aP3D.js";import{r as p}from"./react-CeAUEJ0P.js";import{B as S,S as d,M as Fe,g as $e}from"./index-CqEkO1RD.js";import{a as k}from"./vendor-BhB35ZXg.js";import{d as Re,h as ae}from"./Add-Hd0l8K7I.js";const Ve=async(g,n=0,b=10)=>await k({method:"get",url:`${S}/bookmystarsadmin/highest-qualification/v1/getAllByPagination?pageNumber=${n}&pageSize=${b}`,headers:g}),Le=async(g,n)=>{var b,v,j;try{const a=await k({method:"POST",url:`${S}/bookmystarsadmin/highest-qualification/v1/create`,headers:n,data:g}),r=((b=a==null?void 0:a.data)==null?void 0:b.body)||(a==null?void 0:a.data),o=r==null?void 0:r.code,c=(r==null?void 0:r.message)||"Highest Qualification created successfully",y=(r==null?void 0:r.error)||"An error occurred";o===200?d.fire("Success",c,"success"):o===400?d.fire("Error",y,"error"):d.fire("Success",c,"success")}catch(a){console.error("Error adding highest qualification:",a);const r=((j=(v=a==null?void 0:a.response)==null?void 0:v.data)==null?void 0:j.message)||(a==null?void 0:a.message)||"Failed to add highest qualification";d.fire("Error",r,"error")}},Oe=async(g,n)=>{var b,v,j;try{const a=await k({method:"delete",url:`${S}/bookmystarsadmin/highest-qualification/v1/delete/${g}`,headers:n}),r=((b=a==null?void 0:a.data)==null?void 0:b.body)||(a==null?void 0:a.data),o=r==null?void 0:r.code,c=(r==null?void 0:r.message)||"Highest Qualification deleted successfully",y=(r==null?void 0:r.error)||"An error occurred";o===200?d.fire("Deleted!",c,"success"):o===400?d.fire("Error",y,"error"):d.fire("Deleted!",c,"success")}catch(a){console.error("Error deleting highest qualification:",a);const r=((j=(v=a==null?void 0:a.response)==null?void 0:v.data)==null?void 0:j.message)||(a==null?void 0:a.message)||"Failed to delete highest qualification";d.fire("Error",r,"error")}},Ue=async(g,n)=>await k({method:"GET",url:`${S}/bookmystarsadmin/highest-qualification/v1/get/${g}`,headers:n}),Be=async(g,n)=>{var b,v,j,a,r;try{const o=await k({method:"PUT",url:`${S}/bookmystarsadmin/highest-qualification/v1/update`,headers:n,data:g}),c=((b=o==null?void 0:o.data)==null?void 0:b.body)||(o==null?void 0:o.data),y=c==null?void 0:c.code,Q=(c==null?void 0:c.message)||"Highest Qualification updated successfully",I=(c==null?void 0:c.error)||"An error occurred";y===200?d.fire("Success",Q,"success"):y===400?d.fire("Error",I,"error"):d.fire("Success",Q,"success")}catch(o){console.error("Error updating highest qualification:",o);let c="Failed to update highest qualification";(j=(v=o==null?void 0:o.response)==null?void 0:v.data)!=null&&j.error?c=o.response.data.error:(r=(a=o==null?void 0:o.response)==null?void 0:a.data)!=null&&r.message?c=o.response.data.message:o!=null&&o.message&&(c=o.message),d.fire("Error",c,"error")}},Ge=async g=>await k({method:"GET",url:`${S}/bookmystarsadmin/highest-qualification/v1/count`,headers:g}),R=[{id:"highestQualificationId",label:"ID"},{id:"highestQualificationName",label:"Qualification Name",minWidth:150},{id:"highestQualificationDescription",label:"Description",minWidth:200},{id:"isActive",label:"Status",align:"center"},{id:"insertedDate",label:"Created Date",align:"right"},{id:"updatedDate",label:"Updated Date",align:"right"},{id:"actions",label:"Actions",align:"right"}],Ze=()=>{const g=be(),n=J(g.breakpoints.down("sm")),b=J(g.breakpoints.down("md")),[v,j]=p.useState(0),[a,r]=p.useState(10),[o,c]=p.useState([]),[y,Q]=p.useState(!1),[I,P]=p.useState(!1),[V,se]=p.useState("list"),[x,N]=p.useState({highestQualificationName:"",highestQualificationDescription:"",isActive:!0}),[T,q]=p.useState({}),[oe,L]=p.useState(!1),[ne,O]=p.useState(null),[re,W]=p.useState(0),[U,B]=p.useState(0),le=(t,i)=>{j(i)},ce=t=>{r(+t.target.value),j(0)},he=(t,i)=>{i!==null&&se(i)},u=JSON.parse(sessionStorage.getItem("user")),E={"Content-Type":"application/json",Authorization:"Bearer "+(u==null?void 0:u.accessToken)},de=async()=>{var t;try{if(!u||!u.accessToken){console.error("User not authenticated"),d.fire("Error","Please login to continue","error");return}const i=await Ve(E,v,a),s=((t=i==null?void 0:i.data)==null?void 0:t.body)??(i==null?void 0:i.data),l=s==null?void 0:s.data,h=(l==null?void 0:l.content)||(l==null?void 0:l.highestQualifications)||l||[],C=l!=null&&l.totalElements||l!=null&&l.totalCount||Array.isArray(h)?h.length:0;if(h&&Array.isArray(h)){const D=h.map(m=>{const _=m.isActive!==void 0?m.isActive:m.active!==void 0?m.active:!0;return console.log(`Highest Qualification ${m.highestQualificationName} - isActive field: ${m.isActive}, active field: ${m.active}, final value: ${_}`),{highestQualificationId:m.highestQualificationId,highestQualificationName:m.highestQualificationName||"N/A",highestQualificationDescription:m.highestQualificationDescription||"N/A",isActive:_?"Active":"Inactive",insertedDate:m.insertedDate?ae(m.insertedDate).format("L"):"N/A",updatedDate:m.updatedDate?ae(m.updatedDate).format("L"):"N/A"}});c(D),W(typeof C=="number"?C:0)}else c([]),W(0)}catch(i){console.error("Error fetching data:",i),d.fire("Error","Failed to load highest qualifications. Please try again.","error"),c([]),W(0)}},ue=async()=>{var t;try{const i=await Ge(E),s=((t=i==null?void 0:i.data)==null?void 0:t.body)??(i==null?void 0:i.data),l=(s==null?void 0:s.data)||s||0,h=typeof l=="number"?l:typeof l=="string"&&parseInt(l,10)||0;B(h)}catch(i){console.error("Error fetching highest qualification count:",i),B(0)}};p.useEffect(()=>{de(),ue()},[oe,v,a]),p.useEffect(()=>{if(y)try{document.activeElement&&document.activeElement.blur()}catch{}},[y]);const fe=async t=>{var s,l,h,C;t.preventDefault();const i=ge();if(Object.keys(i).length>0)q(i);else try{if(I){const D={highestQualificationId:ne,highestQualificationName:((s=x.highestQualificationName)==null?void 0:s.trim())||"",highestQualificationDescription:((l=x.highestQualificationDescription)==null?void 0:l.trim())||"",isActive:!!x.isActive,updatedBy:u!=null&&u.userId?{userId:u.userId,userName:u.userName||u.username||"admin"}:{userId:1,userName:"admin"}};await Be(D,E)}else{const D={highestQualificationName:((h=x.highestQualificationName)==null?void 0:h.trim())||"",highestQualificationDescription:((C=x.highestQualificationDescription)==null?void 0:C.trim())||"",isActive:!!x.isActive,insertedBy:u!=null&&u.userId?{userId:u.userId,userName:u.userName||u.username||"admin"}:{userId:1,userName:"admin"}};await Le(D,E)}N({highestQualificationName:"",highestQualificationDescription:"",isActive:!0}),L(D=>!D),Q(!1)}catch(D){console.error("Error saving highest qualification:",D),d.fire("Error","Failed to save highest qualification. Please try again.","error")}},ge=()=>{const t={};return(!x.highestQualificationName||x.highestQualificationName.trim()==="")&&(t.highestQualificationName="Enter the qualification name"),(!x.highestQualificationDescription||x.highestQualificationDescription.trim()==="")&&(t.highestQualificationDescription="Enter the qualification description"),t},z=t=>{const{name:i,value:s,checked:l}=t.target;N({...x,[i]:i==="isActive"?l:s}),q({...T,[i]:null})},xe=()=>{P(!1),N({highestQualificationName:"",highestQualificationDescription:"",isActive:!0}),q({}),Q(!0)},G=()=>{Q(!1),P(!1),N({highestQualificationName:"",highestQualificationDescription:"",isActive:!0}),q({}),O(null)},Y=async t=>{var i;P(!0),Q(!0);try{const s=await Ue(t,E),l=((i=s==null?void 0:s.data)==null?void 0:i.body)??(s==null?void 0:s.data),h=(l==null?void 0:l.data)||l;if(h&&h.highestQualificationId){console.log("Highest Qualification details for edit:",h);const C=h.isActive!==void 0?h.isActive:h.active!==void 0?h.active:!0;O(h.highestQualificationId),N({highestQualificationName:h.highestQualificationName||"",highestQualificationDescription:h.highestQualificationDescription||"",isActive:!!C})}else d.fire("Error","Failed to load highest qualification details","error"),Q(!1)}catch(s){console.error("Error fetching highest qualification details:",s),d.fire("Error","Failed to load highest qualification details. Please try again.","error"),Q(!1)}},X=async t=>{d.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(async i=>{if(i.isConfirmed)try{await Oe(t,E),L(s=>!s),d.fire({title:"Deleted!",text:"Highest Qualification has been deleted.",icon:"success"})}catch(s){d.fire({title:"Error!",text:"There was a problem deleting the highest qualification.",icon:"error"}),console.error("Error deleting highest qualification:",s)}})},me=()=>e.jsx(A,{container:!0,spacing:n?2:3,children:o.length===0?e.jsx(A,{item:!0,xs:12,children:e.jsxs(f,{sx:{textAlign:"center",py:4},children:[e.jsx(w,{variant:"h6",color:"textSecondary",children:"No highest qualifications found"}),e.jsxs(w,{variant:"body2",color:"textSecondary",children:["Highest qualifications array length: ",o.length]})]})}):o.map(t=>e.jsx(A,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsxs(Se,{sx:{height:"100%",display:"flex",flexDirection:"column",background:"linear-gradient(135deg, #E8F5E8 0%, #C8E6C9 100%)",color:"#2E7D32",position:"relative",overflow:"hidden","&:hover":{transform:"translateY(-4px)",boxShadow:"0 8px 25px rgba(0,0,0,0.15)",transition:"all 0.3s ease"}},children:[e.jsx(f,{sx:{position:"absolute",top:0,right:0,width:100,height:100,background:"rgba(255,255,255,0.3)",borderRadius:"50%",transform:"translate(30px, -30px)"}}),e.jsxs(ke,{sx:{flexGrow:1,position:"relative",zIndex:1},children:[e.jsxs(f,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(Ie,{sx:{bgcolor:"rgba(46, 125, 50, 0.2)",mr:2,width:40,height:40,color:"#2E7D32"},children:e.jsx(K,{})}),e.jsxs(f,{children:[e.jsx(w,{variant:"h6",sx:{fontWeight:"bold",mb:.5,color:"#2E7D32"},children:t.highestQualificationName}),e.jsx(f,{sx:{display:"flex",gap:1,alignItems:"center"},children:e.jsx(Ne,{label:t.isActive,size:"small",sx:{bgcolor:t.isActive==="Active"?"rgba(76, 175, 80, 0.9)":"rgba(244, 67, 54, 0.9)",color:"white",fontWeight:"bold"}})})]})]}),e.jsx(w,{variant:"body2",sx:{mb:2,opacity:.8,color:"#2E7D32",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t.highestQualificationDescription}),e.jsx(Te,{sx:{my:1,bgcolor:"rgba(46, 125, 50, 0.2)"}}),e.jsxs(f,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[e.jsxs(w,{variant:"caption",sx:{opacity:.7,color:"#2E7D32"},children:["ID: ",t.highestQualificationId]}),e.jsx(w,{variant:"caption",sx:{opacity:.7,color:"#2E7D32"},children:t.insertedDate})]}),e.jsxs(f,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(w,{variant:"caption",sx:{opacity:.7,color:"#2E7D32"},children:["Updated: ",t.updatedDate]}),e.jsxs(f,{children:[e.jsx(H,{size:"small",onClick:()=>Y(t.highestQualificationId),sx:{color:"#2E7D32","&:hover":{bgcolor:"rgba(46, 125, 50, 0.1)"}},children:e.jsx(ie,{fontSize:"small"})}),e.jsx(H,{size:"small",onClick:()=>X(t.highestQualificationId),sx:{color:"#2E7D32","&:hover":{bgcolor:"rgba(46, 125, 50, 0.1)"}},children:e.jsx(te,{fontSize:"small"})})]})]})]})]})},t.highestQualificationId))}),pe=()=>{const t=n?R.filter(i=>["highestQualificationId","highestQualificationName","actions"].includes(i.id)):b?R.filter(i=>!["insertedDate","updatedDate","highestQualificationDescription"].includes(i.id)):R;return e.jsxs(qe,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(He,{sx:{maxHeight:440,overflowX:"auto","&::-webkit-scrollbar":{height:"8px"},"&::-webkit-scrollbar-track":{backgroundColor:"#f1f1f1"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#888",borderRadius:"4px"},"&::-webkit-scrollbar-thumb:hover":{backgroundColor:"#555"}},children:e.jsxs(Pe,{stickyHeader:!0,"aria-label":"sticky table",sx:{minWidth:n?600:"100%"},children:[e.jsx(We,{children:e.jsx(F,{children:t.map(i=>e.jsx($,{align:i.align,sx:{minWidth:n?i.minWidth?Math.min(i.minWidth,100):"auto":i.minWidth,fontWeight:600,fontSize:n?13:15,whiteSpace:"nowrap",...i.id==="actions"&&{textAlign:"right"}},children:i.label},i.id))})}),e.jsx(ze,{children:o.length===0?e.jsx(F,{children:e.jsx($,{colSpan:t.length,align:"center",children:e.jsx(f,{sx:{py:2},children:e.jsx("div",{children:"No highest qualifications found"})})})}):o.map(i=>e.jsx(F,{hover:!0,role:"checkbox",tabIndex:-1,children:t.map(s=>e.jsx($,{align:s.align,sx:{fontSize:n?12:14,whiteSpace:"nowrap",...s.id==="actions"&&{textAlign:"right"}},children:s.id==="isActive"?e.jsx(f,{sx:{backgroundColor:i.isActive==="Active"?"#4caf50":"#f44336",color:"white",padding:n?"2px 6px":"4px 8px",borderRadius:"4px",fontSize:n?"10px":"12px",fontWeight:"bold",textAlign:"center",display:"inline-block",minWidth:n?60:80},children:i.isActive}):s.id==="actions"?e.jsxs(f,{sx:{display:"flex",gap:.5,flexWrap:"wrap",justifyContent:"flex-end"},children:[e.jsx(H,{size:n?"small":"medium",onClick:()=>Y(i.highestQualificationId),style:{color:"#00afb5"},children:e.jsx(ie,{fontSize:n?"small":"medium"})}),e.jsx(H,{size:n?"small":"medium",onClick:()=>X(i.highestQualificationId),color:"error",children:e.jsx(te,{fontSize:n?"small":"medium"})})]}):e.jsx(w,{variant:"body2",sx:{fontSize:n?12:14,overflow:"hidden",textOverflow:"ellipsis",maxWidth:n?150:"none"},children:i[s.id]})},s.id))},i.highestQualificationId))})]})}),e.jsx(Me,{rowsPerPageOptions:n?[10,25]:[10,25,100],component:"div",count:re,rowsPerPage:a,page:v,onPageChange:le,onRowsPerPageChange:ce,sx:{overflowX:"auto","& .MuiTablePagination-toolbar":{flexWrap:"wrap",gap:1},"& .MuiTablePagination-selectLabel":{fontSize:n?12:14},"& .MuiTablePagination-displayedRows":{fontSize:n?12:14}}})]})};return e.jsxs(f,{sx:{mt:4,px:{xs:1,sm:2}},children:[e.jsxs(Fe,{title:e.jsxs(f,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:{xs:"flex-start",sm:"center"},gap:2,width:"100%"},children:[e.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap"},children:[e.jsx(w,{variant:"h4",sx:{fontSize:{xs:"1.2rem",sm:"1.5rem"}},children:"Highest Qualification Management"}),e.jsx(ve,{badgeContent:typeof U=="number"?U:0,color:"primary",children:e.jsx(K,{color:"action"})})]}),e.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap",width:{xs:"100%",sm:"auto"},justifyContent:{xs:"flex-start",sm:"flex-end"}},children:[e.jsxs(je,{value:V,exclusive:!0,onChange:he,size:"small",children:[e.jsx(Z,{value:"list","aria-label":"list view",children:e.jsx(ye,{})}),e.jsx(Z,{value:"card","aria-label":"card view",children:e.jsx(Qe,{})})]}),e.jsxs(M,{variant:"contained",style:{backgroundColor:"#00afb5",color:"white"},sx:{display:"flex",alignItems:"center",fontSize:{xs:"13px",sm:"15px"},whiteSpace:"nowrap",width:{xs:"100%",sm:"auto"}},onClick:xe,children:[n?"Add":"Add Qualification",e.jsx(Re,{sx:{color:"#fff",ml:.5}})]})]})]}),children:[e.jsx(A,{container:!0,spacing:$e}),V==="card"?me():pe()]}),e.jsxs(De,{open:y,onClose:G,fullWidth:!0,maxWidth:n?"xs":"md",fullScreen:n,children:[e.jsx(we,{sx:{fontWeight:"bold",fontSize:"1.25rem",backgroundColor:"#f5f5f5"},children:I?"Edit Highest Qualification":"Add Highest Qualification"}),e.jsxs(f,{component:"form",onSubmit:fe,noValidate:!0,sx:{p:{xs:2,sm:3}},children:[e.jsxs(A,{container:!0,spacing:2,children:[e.jsx(A,{item:!0,xs:12,md:6,children:e.jsx(ee,{fullWidth:!0,label:"Qualification Name",name:"highestQualificationName",value:x.highestQualificationName,onChange:z,error:!!T.highestQualificationName,helperText:T.highestQualificationName,placeholder:"e.g., Bachelor's Degree, Master's Degree, PhD"})}),e.jsx(A,{item:!0,xs:12,children:e.jsx(ee,{fullWidth:!0,label:"Qualification Description",name:"highestQualificationDescription",value:x.highestQualificationDescription,onChange:z,error:!!T.highestQualificationDescription,helperText:T.highestQualificationDescription,placeholder:"Describe the qualification requirements and details",multiline:!0,rows:4})}),e.jsx(A,{item:!0,xs:12,children:e.jsx(Ae,{control:e.jsx(Ce,{checked:x.isActive,onChange:z,name:"isActive",color:"primary"}),label:"Active Status"})})]}),e.jsxs(Ee,{children:[e.jsx(M,{type:"submit",variant:"contained",style:{backgroundColor:"#00afb5",color:"white"},children:I?"Update":"Add"}),e.jsx(M,{onClick:G,style:{color:"#00afb5"},children:"Cancel"})]})]})]})]})};export{Ze as default};
