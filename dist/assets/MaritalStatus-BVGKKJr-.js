import{u as Dt,q as lt,j as t,a as f,d as E,T as k,ap as At,aI as nt,ar as Mt,as as ot,at as kt,au as Et,n as J,am as It,an as Tt,t as ct,Y as Nt,av as Pt,ao as Wt,c as zt,f as Ft,A as Rt,h as Ot,D as $t,X as U,aj as dt,ak as ut,r as Ut,ad as qt,ae as Lt,af as Jt,ag as V,ah as G,ai as Vt,al as Gt}from"./mui-BHd6aP3D.js";import{r as p}from"./react-CeAUEJ0P.js";import{B as I,S as x,M as Ht,g as Yt}from"./index-CqEkO1RD.js";import{a as W}from"./vendor-BhB35ZXg.js";import{d as Xt,h as mt}from"./Add-Hd0l8K7I.js";const Bt=async(h,n=0,S=10)=>await W({method:"get",url:`${I}/bookmystarsadmin/marital-status/v1/getAllByPagination?pageNumber=${n}&pageSize=${S}`,headers:h}),_t=async(h,n)=>{var S,b,w;try{const l={maritalStatusName:h.maritalStatusName,maritalStatusDescription:h.maritalStatusDescription};console.log("Creating marital status with data:",l);const u=await W({method:"POST",url:`${I}/bookmystarsadmin/marital-status/v1/create`,headers:n,data:l}),m=((S=u==null?void 0:u.data)==null?void 0:S.body)||(u==null?void 0:u.data),j=m==null?void 0:m.code,y=(m==null?void 0:m.message)||"Marital Status created successfully",C=(m==null?void 0:m.error)||"An error occurred";j===200?x.fire("Success",y,"success"):j===400?x.fire("Error",C,"error"):x.fire("Success",y,"success")}catch(l){console.error("Error adding marital status:",l);const u=((w=(b=l==null?void 0:l.response)==null?void 0:b.data)==null?void 0:w.message)||(l==null?void 0:l.message)||"Failed to add marital status";x.fire("Error",u,"error")}},Qt=async(h,n)=>{var S,b,w;try{const l=await W({method:"delete",url:`${I}/bookmystarsadmin/marital-status/v1/delete/${h}`,headers:n}),u=((S=l==null?void 0:l.data)==null?void 0:S.body)||(l==null?void 0:l.data),m=u==null?void 0:u.code,j=(u==null?void 0:u.message)||"Marital Status deleted successfully",y=(u==null?void 0:u.error)||"An error occurred";m===200?x.fire("Deleted!",j,"success"):m===400?x.fire("Error",y,"error"):x.fire("Deleted!",j,"success")}catch(l){console.error("Error deleting marital status:",l);const u=((w=(b=l==null?void 0:l.response)==null?void 0:b.data)==null?void 0:w.message)||(l==null?void 0:l.message)||"Failed to delete marital status";x.fire("Error",u,"error")}},Kt=async(h,n)=>await W({method:"GET",url:`${I}/bookmystarsadmin/marital-status/v1/get/${h}`,headers:n}),Zt=async(h,n)=>{var S,b,w,l,u,m,j,y,C,T,N,z;try{console.log("Attempting to update marital status with data:",h);const e={maritalStatusId:h.maritalStatusId,maritalStatusName:h.maritalStatusName,maritalStatusDescription:h.maritalStatusDescription};console.log("Sending update request to:",`${I}/bookmystarsadmin/marital-status/v1/update`),console.log("Request data:",e),console.log("Request data JSON:",JSON.stringify(e,null,2));const o=await W({method:"PUT",url:`${I}/bookmystarsadmin/marital-status/v1/update`,headers:n,data:e});console.log("Update API response:",o.data),console.log("Response status:",o.status),console.log("Response headers:",o.headers);const d=o==null?void 0:o.data,D=d==null?void 0:d.code,A=(d==null?void 0:d.message)||"Marital Status updated successfully",O=(d==null?void 0:d.error)||"An error occurred";if(console.log("Response body analysis:",{code:D,message:A,error:O,status:d==null?void 0:d.status,data:d==null?void 0:d.data}),D===201||D===200||o.status===201||o.status===200)return{success:!0,message:A,data:d==null?void 0:d.data};if(D===400||o.status===400)throw new Error(O||"Update operation failed");if(o.status>=200&&o.status<300)return{success:!0,message:A,data:d==null?void 0:d.data};throw new Error(A||"Update operation failed")}catch(e){console.error("Error updating marital status:",e),console.log("Detailed API error info:",{status:(S=e==null?void 0:e.response)==null?void 0:S.status,statusText:(b=e==null?void 0:e.response)==null?void 0:b.statusText,data:(w=e==null?void 0:e.response)==null?void 0:w.data,message:e==null?void 0:e.message,config:{url:(l=e==null?void 0:e.config)==null?void 0:l.url,method:(u=e==null?void 0:e.config)==null?void 0:u.method,data:(m=e==null?void 0:e.config)==null?void 0:m.data}}),console.log("Full error response data:",JSON.stringify((j=e==null?void 0:e.response)==null?void 0:j.data,null,2)),console.log("Request data that was sent:",JSON.stringify((y=e==null?void 0:e.config)==null?void 0:y.data,null,2));let o="Failed to update marital status";throw(T=(C=e==null?void 0:e.response)==null?void 0:C.data)!=null&&T.error?o=e.response.data.error:(z=(N=e==null?void 0:e.response)==null?void 0:N.data)!=null&&z.message?o=e.response.data.message:e!=null&&e.message&&(o=e.message),x.fire("Error",o,"error"),e}},ta=async h=>await W({method:"GET",url:`${I}/bookmystarsadmin/marital-status/v1/count`,headers:h}),H=[{id:"maritalStatusId",label:"ID"},{id:"maritalStatusName",label:"Marital Status Name",minWidth:150},{id:"maritalStatusDescription",label:"Description",minWidth:200},{id:"isActive",label:"Status",align:"center"},{id:"insertedDate",label:"Created Date",align:"right"},{id:"updatedDate",label:"Updated Date",align:"right"},{id:"actions",label:"Actions",align:"right"}],la=()=>{const h=Dt(),n=lt(h.breakpoints.down("sm")),S=lt(h.breakpoints.down("md")),[b,w]=p.useState(0),[l,u]=p.useState(10),[m,j]=p.useState([]),[y,C]=p.useState(!1),[T,N]=p.useState(!1),[z,e]=p.useState("list"),[o,d]=p.useState({maritalStatusName:"",maritalStatusDescription:"",isActive:!0}),[D,A]=p.useState({}),[O,Y]=p.useState(!1),[ht,X]=p.useState(null),[gt,q]=p.useState(0),[B,_]=p.useState(0),xt=(s,a)=>{w(a)},ft=s=>{u(+s.target.value),w(0)},pt=(s,a)=>{a!==null&&e(a)},F=JSON.parse(sessionStorage.getItem("user")),P={"Content-Type":"application/json",Authorization:"Bearer "+(F==null?void 0:F.accessToken)},St=async()=>{var s;try{if(!F||!F.accessToken){console.error("User not authenticated"),x.fire("Error","Please login to continue","error");return}const a=await Bt(P,b,l),r=((s=a==null?void 0:a.data)==null?void 0:s.body)??(a==null?void 0:a.data),c=r==null?void 0:r.data,g=(c==null?void 0:c.content)||(c==null?void 0:c.maritalStatuses)||c||[],R=c!=null&&c.totalElements||c!=null&&c.totalCount||Array.isArray(g)?g.length:0;if(g&&Array.isArray(g)){const $=g.map(v=>(console.log(`Marital Status ${v.maritalStatusName} - Raw data:`,v),{maritalStatusId:v.maritalStatusId,maritalStatusName:v.maritalStatusName||"N/A",maritalStatusDescription:v.maritalStatusDescription||"N/A",isActive:"Active",insertedDate:v.insertedDate?mt(v.insertedDate).format("L"):"N/A",updatedDate:v.updatedDate?mt(v.updatedDate).format("L"):"N/A"}));j($),q(typeof R=="number"?R:0)}else j([]),q(0)}catch(a){console.error("Error fetching data:",a),x.fire("Error","Failed to load marital statuses. Please try again.","error"),j([]),q(0)}},bt=async()=>{var s;try{const a=await ta(P),r=((s=a==null?void 0:a.data)==null?void 0:s.body)??(a==null?void 0:a.data),c=(r==null?void 0:r.data)||r||0,g=typeof c=="number"?c:typeof c=="string"&&parseInt(c,10)||0;_(g)}catch(a){console.error("Error fetching marital status count:",a),_(0)}};p.useEffect(()=>{St(),bt()},[O,b,l]),p.useEffect(()=>{if(y)try{document.activeElement&&document.activeElement.blur()}catch{}},[y]);const jt=async s=>{var r,c,g,R,$,v,tt,at,et,st,it,rt;s.preventDefault();const a=vt();if(Object.keys(a).length>0)A(a);else try{if(T){const i={maritalStatusId:ht,maritalStatusName:((r=o.maritalStatusName)==null?void 0:r.trim())||"",maritalStatusDescription:((c=o.maritalStatusDescription)==null?void 0:c.trim())||""},M=await Zt(i,P);M!=null&&M.success&&x.fire("Success",M.message,"success")}else{const i={maritalStatusName:((g=o.maritalStatusName)==null?void 0:g.trim())||"",maritalStatusDescription:((R=o.maritalStatusDescription)==null?void 0:R.trim())||""};await _t(i,P)}d({maritalStatusName:"",maritalStatusDescription:"",isActive:!0}),Y(i=>!i),C(!1)}catch(i){console.error("Error saving marital status:",i);let M="Failed to save marital status. Please try again.";(v=($=i==null?void 0:i.response)==null?void 0:$.data)!=null&&v.message?M=i.response.data.message:(at=(tt=i==null?void 0:i.response)==null?void 0:tt.data)!=null&&at.error?M=i.response.data.error:i!=null&&i.message&&(M=i.message),console.log("Detailed error info:",{status:(et=i==null?void 0:i.response)==null?void 0:et.status,statusText:(st=i==null?void 0:i.response)==null?void 0:st.statusText,data:(it=i==null?void 0:i.response)==null?void 0:it.data,message:i==null?void 0:i.message}),console.log("Full error response data:",JSON.stringify((rt=i==null?void 0:i.response)==null?void 0:rt.data,null,2)),x.fire("Error",M,"error")}},vt=()=>{const s={};return(!o.maritalStatusName||o.maritalStatusName.trim()==="")&&(s.maritalStatusName="Enter the marital status name"),(!o.maritalStatusDescription||o.maritalStatusDescription.trim()==="")&&(s.maritalStatusDescription="Enter the marital status description"),s},L=s=>{const{name:a,value:r,checked:c}=s.target;d({...o,[a]:a==="isActive"?c:r}),A({...D,[a]:null})},wt=()=>{N(!1),d({maritalStatusName:"",maritalStatusDescription:"",isActive:!0}),A({}),C(!0)},Q=()=>{C(!1),N(!1),d({maritalStatusName:"",maritalStatusDescription:"",isActive:!0}),A({}),X(null)},K=async s=>{var a;N(!0),C(!0);try{const r=await Kt(s,P),c=((a=r==null?void 0:r.data)==null?void 0:a.body)??(r==null?void 0:r.data),g=(c==null?void 0:c.data)||c;g&&g.maritalStatusId?(console.log("Marital Status details for edit:",g),console.log("Edit - Raw marital status data:",g),X(g.maritalStatusId),d({maritalStatusName:g.maritalStatusName||"",maritalStatusDescription:g.maritalStatusDescription||"",isActive:!0})):(x.fire("Error","Failed to load marital status details","error"),C(!1))}catch(r){console.error("Error fetching marital status details:",r),x.fire("Error","Failed to load marital status details. Please try again.","error"),C(!1)}},Z=async s=>{x.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(async a=>{if(a.isConfirmed)try{await Qt(s,P),Y(r=>!r),x.fire({title:"Deleted!",text:"Marital Status has been deleted.",icon:"success"})}catch(r){x.fire({title:"Error!",text:"There was a problem deleting the marital status.",icon:"error"}),console.error("Error deleting marital status:",r)}})},yt=()=>t.jsx(E,{container:!0,spacing:n?2:3,children:m.length===0?t.jsx(E,{item:!0,xs:12,children:t.jsxs(f,{sx:{textAlign:"center",py:4},children:[t.jsx(k,{variant:"h6",color:"textSecondary",children:"No marital statuses found"}),t.jsxs(k,{variant:"body2",color:"textSecondary",children:["Marital statuses array length: ",m.length]})]})}):m.map(s=>t.jsx(E,{item:!0,xs:12,sm:6,md:4,lg:3,children:t.jsxs(zt,{sx:{height:"100%",display:"flex",flexDirection:"column",background:"linear-gradient(135deg, #FCE4EC 0%, #F8BBD9 100%)",color:"#C2185B",position:"relative",overflow:"hidden","&:hover":{transform:"translateY(-4px)",boxShadow:"0 8px 25px rgba(0,0,0,0.15)",transition:"all 0.3s ease"}},children:[t.jsx(f,{sx:{position:"absolute",top:0,right:0,width:100,height:100,background:"rgba(255,255,255,0.3)",borderRadius:"50%",transform:"translate(30px, -30px)"}}),t.jsxs(Ft,{sx:{flexGrow:1,position:"relative",zIndex:1},children:[t.jsxs(f,{sx:{display:"flex",alignItems:"center",mb:2},children:[t.jsx(Rt,{sx:{bgcolor:"rgba(194, 24, 91, 0.2)",mr:2,width:40,height:40,color:"#C2185B"},children:t.jsx(nt,{})}),t.jsxs(f,{children:[t.jsx(k,{variant:"h6",sx:{fontWeight:"bold",mb:.5,color:"#C2185B"},children:s.maritalStatusName}),t.jsx(f,{sx:{display:"flex",gap:1,alignItems:"center"},children:t.jsx(Ot,{label:s.isActive,size:"small",sx:{bgcolor:s.isActive==="Active"?"rgba(76, 175, 80, 0.9)":"rgba(244, 67, 54, 0.9)",color:"white",fontWeight:"bold"}})})]})]}),t.jsx(k,{variant:"body2",sx:{mb:2,opacity:.8,color:"#C2185B",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden"},children:s.maritalStatusDescription}),t.jsx($t,{sx:{my:1,bgcolor:"rgba(194, 24, 91, 0.2)"}}),t.jsxs(f,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[t.jsxs(k,{variant:"caption",sx:{opacity:.7,color:"#C2185B"},children:["ID: ",s.maritalStatusId]}),t.jsx(k,{variant:"caption",sx:{opacity:.7,color:"#C2185B"},children:s.insertedDate})]}),t.jsxs(f,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs(k,{variant:"caption",sx:{opacity:.7,color:"#C2185B"},children:["Updated: ",s.updatedDate]}),t.jsxs(f,{children:[t.jsx(U,{size:"small",onClick:()=>K(s.maritalStatusId),sx:{color:"#C2185B","&:hover":{bgcolor:"rgba(194, 24, 91, 0.1)"}},children:t.jsx(dt,{fontSize:"small"})}),t.jsx(U,{size:"small",onClick:()=>Z(s.maritalStatusId),sx:{color:"#C2185B","&:hover":{bgcolor:"rgba(194, 24, 91, 0.1)"}},children:t.jsx(ut,{fontSize:"small"})})]})]})]})]})},s.maritalStatusId))}),Ct=()=>{const s=n?H.filter(a=>["maritalStatusId","maritalStatusName","actions"].includes(a.id)):S?H.filter(a=>!["insertedDate","updatedDate","maritalStatusDescription"].includes(a.id)):H;return t.jsxs(Ut,{sx:{width:"100%",overflow:"hidden"},children:[t.jsx(qt,{sx:{maxHeight:440,overflowX:"auto","&::-webkit-scrollbar":{height:"8px"},"&::-webkit-scrollbar-track":{backgroundColor:"#f1f1f1"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#888",borderRadius:"4px"},"&::-webkit-scrollbar-thumb:hover":{backgroundColor:"#555"}},children:t.jsxs(Lt,{stickyHeader:!0,"aria-label":"sticky table",sx:{minWidth:n?600:"100%"},children:[t.jsx(Jt,{children:t.jsx(V,{children:s.map(a=>t.jsx(G,{align:a.align,sx:{minWidth:n?a.minWidth?Math.min(a.minWidth,100):"auto":a.minWidth,fontWeight:600,fontSize:n?13:15,whiteSpace:"nowrap",...a.id==="actions"&&{textAlign:"right"}},children:a.label},a.id))})}),t.jsx(Vt,{children:m.length===0?t.jsx(V,{children:t.jsx(G,{colSpan:s.length,align:"center",children:t.jsx(f,{sx:{py:2},children:t.jsx("div",{children:"No marital statuses found"})})})}):m.map(a=>t.jsx(V,{hover:!0,role:"checkbox",tabIndex:-1,children:s.map(r=>t.jsx(G,{align:r.align,sx:{fontSize:n?12:14,whiteSpace:"nowrap",...r.id==="actions"&&{textAlign:"right"}},children:r.id==="isActive"?t.jsx(f,{sx:{backgroundColor:a.isActive==="Active"?"#4caf50":"#f44336",color:"white",padding:n?"2px 6px":"4px 8px",borderRadius:"4px",fontSize:n?"10px":"12px",fontWeight:"bold",textAlign:"center",display:"inline-block",minWidth:n?60:80},children:a.isActive}):r.id==="actions"?t.jsxs(f,{sx:{display:"flex",gap:.5,flexWrap:"wrap",justifyContent:"flex-end"},children:[t.jsx(U,{size:n?"small":"medium",onClick:()=>K(a.maritalStatusId),style:{color:"#00afb5"},children:t.jsx(dt,{fontSize:n?"small":"medium"})}),t.jsx(U,{size:n?"small":"medium",onClick:()=>Z(a.maritalStatusId),color:"error",children:t.jsx(ut,{fontSize:n?"small":"medium"})})]}):t.jsx(k,{variant:"body2",sx:{fontSize:n?12:14,overflow:"hidden",textOverflow:"ellipsis",maxWidth:n?150:"none"},children:a[r.id]})},r.id))},a.maritalStatusId))})]})}),t.jsx(Gt,{rowsPerPageOptions:n?[10,25]:[10,25,100],component:"div",count:gt,rowsPerPage:l,page:b,onPageChange:xt,onRowsPerPageChange:ft,sx:{overflowX:"auto","& .MuiTablePagination-toolbar":{flexWrap:"wrap",gap:1},"& .MuiTablePagination-selectLabel":{fontSize:n?12:14},"& .MuiTablePagination-displayedRows":{fontSize:n?12:14}}})]})};return t.jsxs(f,{sx:{mt:4,px:{xs:1,sm:2}},children:[t.jsxs(Ht,{title:t.jsxs(f,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:{xs:"flex-start",sm:"center"},gap:2,width:"100%"},children:[t.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap"},children:[t.jsx(k,{variant:"h4",sx:{fontSize:{xs:"1.2rem",sm:"1.5rem"}},children:"Marital Status Management"}),t.jsx(At,{badgeContent:typeof B=="number"?B:0,color:"primary",children:t.jsx(nt,{color:"action"})})]}),t.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap",width:{xs:"100%",sm:"auto"},justifyContent:{xs:"flex-start",sm:"flex-end"}},children:[t.jsxs(Mt,{value:z,exclusive:!0,onChange:pt,size:"small",children:[t.jsx(ot,{value:"list","aria-label":"list view",children:t.jsx(kt,{})}),t.jsx(ot,{value:"card","aria-label":"card view",children:t.jsx(Et,{})})]}),t.jsxs(J,{variant:"contained",style:{backgroundColor:"#00afb5",color:"white"},sx:{display:"flex",alignItems:"center",fontSize:{xs:"13px",sm:"15px"},whiteSpace:"nowrap",width:{xs:"100%",sm:"auto"}},onClick:wt,children:[n?"Add":"Add Marital Status",t.jsx(Xt,{sx:{color:"#fff",ml:.5}})]})]})]}),children:[t.jsx(E,{container:!0,spacing:Yt}),z==="card"?yt():Ct()]}),t.jsxs(It,{open:y,onClose:Q,fullWidth:!0,maxWidth:n?"xs":"md",fullScreen:n,children:[t.jsx(Tt,{sx:{fontWeight:"bold",fontSize:"1.25rem",backgroundColor:"#f5f5f5"},children:T?"Edit Marital Status":"Add Marital Status"}),t.jsxs(f,{component:"form",onSubmit:jt,noValidate:!0,sx:{p:{xs:2,sm:3}},children:[t.jsxs(E,{container:!0,spacing:2,children:[t.jsx(E,{item:!0,xs:12,md:6,children:t.jsx(ct,{fullWidth:!0,label:"Marital Status Name",name:"maritalStatusName",value:o.maritalStatusName,onChange:L,error:!!D.maritalStatusName,helperText:D.maritalStatusName,placeholder:"e.g., Single, Married, Divorced, Widowed"})}),t.jsx(E,{item:!0,xs:12,children:t.jsx(ct,{fullWidth:!0,label:"Marital Status Description",name:"maritalStatusDescription",value:o.maritalStatusDescription,onChange:L,error:!!D.maritalStatusDescription,helperText:D.maritalStatusDescription,placeholder:"Describe the marital status and its characteristics",multiline:!0,rows:4})}),t.jsx(E,{item:!0,xs:12,children:t.jsx(Nt,{control:t.jsx(Pt,{checked:o.isActive,onChange:L,name:"isActive",color:"primary"}),label:"Active Status"})})]}),t.jsxs(Wt,{children:[t.jsx(J,{type:"submit",variant:"contained",style:{backgroundColor:"#00afb5",color:"white"},children:T?"Update":"Add"}),t.jsx(J,{onClick:Q,style:{color:"#00afb5"},children:"Cancel"})]})]})]})]})};export{la as default};
